@model WebSite.Models.Data.NotificationSettings
@section Scripts
{
    @Scripts.Render("~/bundles/jqueryui")
    <script type="text/javascript">
        $(function ()
        {
            var cancellationDialog = $("#cancellation-dialog-div").dialog({
                resizable: false,
                modal: true,
                autoOpen: false,
                width: 'auto',
                draggable: false,
                title: "Cancelling Subscription",
                buttons: {
                    "Cancel Subscription": function ()
                    {
                        window.location.href = '@(Url.Action("CancelSubscription"))';
                    },
                    "Don't Cancel Subscription": function ()
                    {
                        $(this).dialog("close");
                    }
                }
            });

            $("#cancellation-link-a").click(function()
            {
                $("#cancellation-dialog-div").dialog('open');
            });
        });
    </script>
}
<h2>Subscription Settings</h2>
<div id="cancellation-dialog-div">
    Are you sure you want to cancel your subscription?
</div>
<div style="padding-top: 10px; padding-bottom: 10px;">
@if (ViewBag.IsTrialMember && !ViewBag.IsUsingCancelledSubscription)
{
    if (ViewBag.IsTrialExpired)
    {
        <span>Your trial has expired. Please subscribe to continue enjoying our services! @Html.ActionLink("Subscribe Now", "Subscribe")</span>
    }
    else
    {
        <span>Your trial will expire in @(ViewBag.TrialDaysLeft) days. @Html.ActionLink("Subscribe now", "Subscribe") to ensure you receive uninterrupted service.</span>
    }
}
else if (ViewBag.IsUsingCancelledSubscription)
{
    <span>You have cancelled your subscription but may use the website until @ViewBag.SubscriptionExpiryDate. Please @Html.ActionLink("resubscribe", "Subscribe") to continue using the website after @ViewBag.SubscriptionExpiryDate.</span>
}
else
{
    <span>You have an active @ViewBag.SubscriptionFrequency subscription. <a href="#" id="cancellation-link-a">Cancel Subscription</a></span>
}
</div>
<h2>Notification Settings</h2>
@if (ViewBag.SavedSuccessfully)
{
    <p class="message-success">Changes have been saved.</p>
}
@using (Html.BeginForm())
{
    <div style="padding-top: 10px;">
            @Html.CheckBoxFor(m => m.ReceiveDailyAlerts) @Html.LabelFor(m => m.ReceiveDailyAlerts, new { @style = "display: inline;" })<br />
            @Html.CheckBoxFor(m => m.ReceiveStockPicks) @Html.LabelFor(m => m.ReceiveStockPicks, new { @style = "display: inline;" })<br />
            @Html.CheckBoxFor(m => m.ReceiveOptionPicks) @Html.LabelFor(m => m.ReceiveOptionPicks, new { @style = "display: inline;" })<br />
            @Html.CheckBoxFor(m => m.ReceiveGeneralAnnouncements) @Html.LabelFor(m => m.ReceiveGeneralAnnouncements, new { @style = "display: inline;" })<br />
    </div>
    <div style="padding-top: 10px; width: 100%; text-align: right;">
        <input type="submit" value="Save Changes" />
    </div>
}
<div style="text-align: right; padding-top: 8px;">@Html.ActionLink("Change Password", "ChangePassword", "Account")</div>
